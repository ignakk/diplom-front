import Cookies from 'js-cookie';
import React from 'react';
import { useDispatch, useSelector } from 'react-redux';
import { Link, useHistory } from 'react-router-dom';

import { Button } from '../';
import { AdminView } from '../../App';
import { setUnAuth } from '../../redux/actions/userActions';

import './Header.scss';

export default React.memo(function Header({ isAuth }) {

  const isAuthed = useSelector((state) => state.userReducer.isAuth);
  const dispatch = useDispatch();

  const history = useHistory();

  const logout = () => {
    Cookies.remove('refreshToken');
    localStorage.removeItem('token');
    history.push('/auth');
    dispatch(setUnAuth());
  }

  return (
    <header className="header">
      <div className="header__inner">
        <Link to="/">
          <div className="header__inner-logo">
          <svg width="381" height="71" viewBox="0 0 381 71" fill="none" xmlns="http://www.w3.org/2000/svg">
          <rect width="354" height="71" fill="#292929"/>
          <rect x="154" y="10" width="61" height="54" fill="black"/>
          <path d="M180 35H190.5" stroke="white" stroke-width="4"/>
          <path d="M26.4688 49V22.5869H30.8047V49H26.4688ZM49.7325 34.6553H59.5968V47.916C58.2117 48.3737 56.7784 48.729 55.297 48.9819C53.8155 49.2349 52.1534 49.3613 50.3106 49.3613C47.6248 49.3613 45.3484 48.8314 43.4815 47.7715C41.6267 46.6995 40.2175 45.1519 39.254 43.1284C38.2904 41.0929 37.8087 38.6419 37.8087 35.7754C37.8087 33.0173 38.3446 30.6265 39.4166 28.603C40.4885 26.5675 42.0483 24.9958 44.0958 23.8877C46.1433 22.7676 48.6244 22.2075 51.5391 22.2075C52.9724 22.2075 54.3575 22.3521 55.6944 22.6411C57.0434 22.9181 58.2779 23.3035 59.398 23.7974L57.8804 27.3745C56.9892 26.953 55.9895 26.5977 54.8814 26.3086C53.7734 26.0195 52.6231 25.875 51.4307 25.875C49.5398 25.875 47.9078 26.2845 46.5347 27.1035C45.1737 27.9225 44.1259 29.0788 43.3912 30.5723C42.6565 32.0537 42.2891 33.8062 42.2891 35.8296C42.2891 37.7928 42.5842 39.5151 43.1744 40.9966C43.7646 42.478 44.686 43.6343 45.9386 44.4653C47.2032 45.2843 48.8352 45.6938 50.8346 45.6938C51.8342 45.6938 52.6833 45.6396 53.3819 45.5312C54.0805 45.4229 54.7249 45.3024 55.315 45.1699V38.3589H49.7325V34.6553ZM89.256 49H83.9264L70.9909 27.9165H70.8283C70.8765 28.6271 70.9186 29.3799 70.9547 30.1748C71.0029 30.9697 71.0391 31.7887 71.0631 32.6318C71.0993 33.4749 71.1294 34.3301 71.1535 35.1973V49H67.215V22.5869H72.5085L85.4259 43.5259H85.5524C85.5283 42.9116 85.4982 42.207 85.4621 41.4121C85.4259 40.6172 85.3898 39.7982 85.3537 38.9551C85.3296 38.0999 85.3115 37.2749 85.2995 36.48V22.5869H89.256V49ZM113.857 49L111.273 41.665H101.174L98.5906 49H94.0198L103.848 22.4785H108.654L118.464 49H113.857ZM110.153 37.9434L107.642 30.7168C107.545 30.4036 107.407 29.964 107.226 29.3979C107.046 28.8198 106.865 28.2357 106.684 27.6455C106.504 27.0433 106.353 26.5374 106.233 26.1279C106.112 26.6217 105.962 27.1758 105.781 27.79C105.612 28.3923 105.444 28.9583 105.275 29.4883C105.119 30.0182 104.998 30.4277 104.914 30.7168L102.385 37.9434H110.153ZM132.405 49H128.051V26.2725H120.319V22.5869H140.119V26.2725H132.405V49ZM145.461 49V22.5869H149.797V49H145.461ZM181.516 35.7573C181.516 37.8169 181.251 39.6958 180.721 41.394C180.191 43.0923 179.396 44.5436 178.336 45.748C177.277 46.9525 175.94 47.8618 174.326 48.4761L180.613 55.2871H174.832L169.863 49.3433C169.743 49.3433 169.622 49.3433 169.502 49.3433C169.394 49.3553 169.285 49.3613 169.177 49.3613C167.069 49.3613 165.238 49.0361 163.685 48.3857C162.143 47.7354 160.86 46.8079 159.836 45.6035C158.825 44.3991 158.066 42.9598 157.56 41.2856C157.054 39.6115 156.801 37.7567 156.801 35.7212C156.801 32.9992 157.247 30.6265 158.138 28.603C159.041 26.5675 160.409 24.9897 162.239 23.8696C164.082 22.7375 166.407 22.1714 169.213 22.1714C171.959 22.1714 174.241 22.7314 176.06 23.8516C177.879 24.9717 179.24 26.5495 180.143 28.585C181.058 30.6084 181.516 32.9992 181.516 35.7573ZM161.354 35.7573C161.354 37.7928 161.631 39.5573 162.185 41.0508C162.739 42.5322 163.588 43.6764 164.732 44.4834C165.889 45.2783 167.37 45.6758 169.177 45.6758C170.995 45.6758 172.477 45.2783 173.621 44.4834C174.765 43.6764 175.608 42.5322 176.15 41.0508C176.692 39.5573 176.963 37.7928 176.963 35.7573C176.963 32.6619 176.343 30.241 175.103 28.4946C173.874 26.7362 171.911 25.8569 169.213 25.8569C167.406 25.8569 165.919 26.2544 164.75 27.0493C163.594 27.8442 162.739 28.9824 162.185 30.4639C161.631 31.9333 161.354 33.6978 161.354 35.7573ZM211.934 35.7573C211.934 37.8169 211.669 39.6958 211.139 41.394C210.609 43.0923 209.814 44.5436 208.754 45.748C207.695 46.9525 206.358 47.8618 204.744 48.4761L211.031 55.2871H205.25L200.281 49.3433C200.161 49.3433 200.04 49.3433 199.92 49.3433C199.812 49.3553 199.703 49.3613 199.595 49.3613C197.487 49.3613 195.656 49.0361 194.103 48.3857C192.561 47.7354 191.278 46.8079 190.254 45.6035C189.243 44.3991 188.484 42.9598 187.978 41.2856C187.472 39.6115 187.219 37.7567 187.219 35.7212C187.219 32.9992 187.665 30.6265 188.556 28.603C189.46 26.5675 190.827 24.9897 192.657 23.8696C194.5 22.7375 196.825 22.1714 199.631 22.1714C202.377 22.1714 204.659 22.7314 206.478 23.8516C208.297 24.9717 209.658 26.5495 210.561 28.585C211.476 30.6084 211.934 32.9992 211.934 35.7573ZM191.772 35.7573C191.772 37.7928 192.049 39.5573 192.603 41.0508C193.157 42.5322 194.006 43.6764 195.15 44.4834C196.307 45.2783 197.788 45.6758 199.595 45.6758C201.413 45.6758 202.895 45.2783 204.039 44.4834C205.183 43.6764 206.026 42.5322 206.568 41.0508C207.11 39.5573 207.381 37.7928 207.381 35.7573C207.381 32.6619 206.761 30.241 205.521 28.4946C204.292 26.7362 202.329 25.8569 199.631 25.8569C197.824 25.8569 196.337 26.2544 195.169 27.0493C194.012 27.8442 193.157 28.9824 192.603 30.4639C192.049 31.9333 191.772 33.6978 191.772 35.7573ZM229.808 22.5869H237.667C241.076 22.5869 243.647 23.0807 245.382 24.0684C247.116 25.056 247.983 26.7603 247.983 29.1812C247.983 30.1929 247.802 31.1082 247.441 31.9272C247.092 32.7342 246.58 33.4027 245.905 33.9326C245.231 34.4505 244.4 34.7998 243.412 34.9805V35.1611C244.436 35.3418 245.345 35.661 246.14 36.1187C246.947 36.5763 247.58 37.2327 248.037 38.0879C248.507 38.943 248.742 40.0511 248.742 41.4121C248.742 43.026 248.356 44.3991 247.586 45.5312C246.827 46.6634 245.737 47.5246 244.316 48.1147C242.906 48.7049 241.232 49 239.293 49H229.808V22.5869ZM234.144 33.481H238.3C240.263 33.481 241.624 33.1618 242.383 32.5234C243.141 31.8851 243.521 30.9517 243.521 29.7231C243.521 28.4705 243.069 27.5672 242.166 27.0132C241.274 26.4591 239.853 26.1821 237.902 26.1821H234.144V33.481ZM234.144 36.9858V45.3687H238.715C240.738 45.3687 242.16 44.9772 242.979 44.1943C243.798 43.4115 244.207 42.3516 244.207 41.0146C244.207 40.1956 244.021 39.485 243.647 38.8828C243.286 38.2806 242.69 37.8169 241.859 37.4917C241.028 37.1545 239.907 36.9858 238.498 36.9858H234.144ZM255.493 49V22.5869H259.829V45.3145H271.048V49H255.493ZM300.364 35.7573C300.364 37.7928 300.105 39.6476 299.587 41.3218C299.081 42.9839 298.317 44.4172 297.293 45.6216C296.269 46.814 294.986 47.7354 293.445 48.3857C291.903 49.0361 290.096 49.3613 288.025 49.3613C285.917 49.3613 284.086 49.0361 282.533 48.3857C280.991 47.7354 279.708 46.8079 278.684 45.6035C277.673 44.3991 276.914 42.9598 276.408 41.2856C275.902 39.6115 275.649 37.7567 275.649 35.7212C275.649 32.9992 276.095 30.6265 276.986 28.603C277.89 26.5675 279.257 24.9897 281.087 23.8696C282.93 22.7375 285.255 22.1714 288.061 22.1714C290.807 22.1714 293.089 22.7314 294.908 23.8516C296.727 24.9717 298.088 26.5495 298.991 28.585C299.906 30.6084 300.364 32.9992 300.364 35.7573ZM280.202 35.7573C280.202 37.7928 280.479 39.5573 281.033 41.0508C281.587 42.5322 282.436 43.6764 283.58 44.4834C284.737 45.2783 286.218 45.6758 288.025 45.6758C289.843 45.6758 291.325 45.2783 292.469 44.4834C293.613 43.6764 294.456 42.5322 294.998 41.0508C295.54 39.5573 295.811 37.7928 295.811 35.7573C295.811 32.6619 295.191 30.241 293.951 28.4946C292.722 26.7362 290.759 25.8569 288.061 25.8569C286.254 25.8569 284.767 26.2544 283.599 27.0493C282.442 27.8442 281.587 28.9824 281.033 30.4639C280.479 31.9333 280.202 33.6978 280.202 35.7573ZM317.991 34.6553H327.855V47.916C326.47 48.3737 325.037 48.729 323.556 48.9819C322.074 49.2349 320.412 49.3613 318.569 49.3613C315.883 49.3613 313.607 48.8314 311.74 47.7715C309.885 46.6995 308.476 45.1519 307.513 43.1284C306.549 41.0929 306.067 38.6419 306.067 35.7754C306.067 33.0173 306.603 30.6265 307.675 28.603C308.747 26.5675 310.307 24.9958 312.354 23.8877C314.402 22.7676 316.883 22.2075 319.798 22.2075C321.231 22.2075 322.616 22.3521 323.953 22.6411C325.302 22.9181 326.537 23.3035 327.657 23.7974L326.139 27.3745C325.248 26.953 324.248 26.5977 323.14 26.3086C322.032 26.0195 320.882 25.875 319.689 25.875C317.798 25.875 316.166 26.2845 314.793 27.1035C313.432 27.9225 312.385 29.0788 311.65 30.5723C310.915 32.0537 310.548 33.8062 310.548 35.8296C310.548 37.7928 310.843 39.5151 311.433 40.9966C312.023 42.478 312.945 43.6343 314.197 44.4653C315.462 45.2843 317.094 45.6938 319.093 45.6938C320.093 45.6938 320.942 45.6396 321.641 45.5312C322.339 45.4229 322.984 45.3024 323.574 45.1699V38.3589H317.991V34.6553Z" fill="white"/>
          </svg>
          </div>
        </Link>

        <div className='header-wrap' style={{display: 'flex', alignItems: 'center'}}>
          <AdminView>
              <div className="header__inner-createarticle">
                <Link to="/articles-to-moderate">
                  <Button className="header__inner-btn">Модерация постов</Button>
                </Link>
              </div>
          </AdminView>

          {isAuth === true && (
            <div className="header__inner-createarticle">
              <Link to="/create">
                <Button className="header__inner-btn">Новая статья</Button>
              </Link>
            </div>
          )}

          <div className="header__inner-createarticle">
              {isAuthed ? 
                <Button onClick={logout} className="header__inner-btn">Выйти</Button>
              :
              <Link to="/auth">
                <Button className="header__inner-btn">Войти</Button>
              </Link>}
          </div>
        
        </div>    

      </div>
    </header>
  );
});
